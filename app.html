<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/joselmm/sheet-data/src/sheetdata.js"></script>
  <link rel="icon" type="image/png" href="imagenpv.png">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<title>Cuentas de Prime y Disney</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    table.table{
      font-size: 10px!important;
    }
    /*a{
      text-decoration: none!important;
    }*/
   
  </style>
</head>
<body id="body">

     

<nav class="navbar navbar-expand-sm navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="javascript:void(0)">Jose The Promation</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" href="./?=prime">Prime Video</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./?=disney">Disney</a>
        </li>
      </ul>


<script type="text/javascript">

  if (sessionStorage.length===0){
  var result = window.prompt("user");
  var password = window.prompt("password");
  
  fm= new FormData()
  fm.append("data",'{"user":"'+result+'","password":"'+password+'"}')


fetch("https://script.google.com/macros/s/AKfycbyP00eK7qQOlyl3itYSCwbUNOelHzmMum9sbffkoZ7fe6_7BF-dAWs8g0dvnj14YBfF/exec",{
    method:"POST",
    body:fm
}).then((res)=>{
    return res.json()
}).then((json)=>{
       console.log(json)
  if(json.res==='ok'){
   sessionStorage.setItem("urlBD", json.urlBD);
      sessionStorage.setItem("sheetJson", json.sheetJson);
 sessionStorage.setItem(json.cache, JSON.stringify(json));
  }

  if(sessionStorage.getItem(json.cache)){

      var split = location.search.replace('?', '').split('&').map(function(val){
      return val.split('=');
      });

      if(split[0][1]=="prime"){
        $("#body").load(json.prime);
      } else if (split[0][1]=="disney") {
        $("#body").load(json.disney);
      }else{
        $("#body").load(json.prime);
      }

  }

  })

  }

  if(sessionStorage.length){
      cache = JSON.parse(cache);
      var cacheA;
      for (variable in cache) {
        cacheA = JSON.parse(cache[variable])
      }


      var split = location.search.replace('?', '').split('&').map(function(val){
      return val.split('=');
      });

       if(split[0][1]=="prime" || split[0][1]=="prime/"){
        $("#body").load(cacheA.prime);
      } else if (split[0][1]=="disney" || split[0][1]=="disney/") {
        $("#body").load(cacheA.disney);
      }else{
        $("#body").load(cacheA.prime);
      }

  }

</script>

</body>
</html>
